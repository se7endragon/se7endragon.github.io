---
layout: post
title: "Data Mining Lecture"
date: 2019-04-18
image: '/assets/img/'
description: 'Lecture 7'
categories:
- Lecture Notes
- Data Mining
---

# 결정 분석적 사고: 좋은 모델은?

군집분석을 이용한다면 더 정확한 회귀분석이 가능하다. 클러스터링을 함으로써 모델링 스코프를 좁히면 더 세밀한 2차분석이 가능하기 때문. 이때문에 EDA에서 군집분석을 진행함.

이탈고객 최소화 예제에서 아래와 같은 프로세스로 진행해볼수 있다.
1. 이탈커스터머들의 프로파일을 identify한다.클러스터링으로.
2. 가장 profitable한 커스터머들의 프로파일 역시 identify한다. 클러스터링으로.
3. 나머지 고객들을 이탈/불이탈 분류로 classification.
4. Promotion planning.

### 결정 분석적 사고의 필요성
- 데이터 관련자들은 데이터마이닝의 목적과 실제 결과를 일치시키지 못하는경우가 종종 있음. 진정으로 측정하려고 하는 것이 무엇인지 주의깊게 생각하는 것이 중요하다.
- 분류정확도의 문제점
  - 편중된 계층문제 (한 계층에 속한 객체수가 매우 적은 경우 발생)
    - 계층분배가 편중되어 있을수록 정확도에 기반한 평가는 실효성이 저하됨.(오버샘플링도 소용이 없을듯 99:1 이런식이면)
    - SMOTE으로 오버샘플링해서 5:5의 sample에서 나온 혼동행렬이 있으면 population의 비율에 따라 실제 모집단에 대한 false positive, false negative를 구함으로써 train데이터의 정확도로만으로는 알수 없는 객관적인 모델 정확성을 구할 수 있다.
  - 비용대비 효과의 불균형 문제 (단지 오류 횟수만을 계산함으로써 오류들의 가중치가 똑같다는 가정에서 오는 문 -> 암걸린환자에게 음성판정하는거랑 정상한테 양성판정하는 것은 오류의 가중치가 실제로 똑같지않잖음?)

### 기댓값 (Expected Value)
혼동행렬을 종합적으로 반영하여 모델을 적용했을때 얼마만큼의 기대수익을 발생시키느냐로 정의가능.
- EV = p(o1) * v(o1) + p(o2) * v(o2) + ...
- p와 v는 각각의 confusion matrix를 만들어서 각각의 셀끼리 곱함.

타겟마케팅 사례에서 프로모션 응하고안하고의 문제에서,
프로모션에 응할 확률 * 응해서 생기는 수익 + 프로모션에 안응할확률 * 프로모션에 들어가는 비용
그래서 기대값이 0 이상일때 나오는 Pr(x)를 구하고 이에 따른 각 고객별 응할 확률이 Pr(x)보다 클때 프로모션 진행하면 이득인 부분.

결론적으로 비용과 효과(Cost/Benefit Info)가 있으면 분석결과로 나온 test data에 대한 Confusion Matrix를 이용하여 Expected Value 계산가능.

- 대부분의 경우 계산의 효율성을 위해 비용과 효과의 평균을 사용.
- True Positive : 타겟팅되어 실제로 제품을 구입한 경우, 수익 - 생산비용 - 프로모션비용
- False Positive : 프로모션에 응할거라고 분류해 프로모션 했지만 실제로 응답하지않은경우. -프로모션 비용
- False Negative : 프로모션에 응하지않을거라고 생각했지만 했으면 응했을 경우. 이경우는 걍 0.
- True Negative : 0.

기댓값이 높아도 정확도가 낮을수도있음. 나오는 기댓값은 각 고객당 프로모션 우편물 발송시 남는 수익.

#### 기댓값 계산: 사전계층(Class Prior) 이용
Unbalanced Population
- 전체모집단 분포에 대한 고려가 없이 진행되면 모델간 비교 시 문제 발생할 가능성 존재.
- 모집단에 존재하는 계층 불균형이 미치는 영향을 제거해 모델의 근본적인 예측능력을 비교 평가 가능.
- 기댓값 측정시 class priors 및 혼동행렬에서 도출된 비율과 비용과 효과를 적용하기 위한 변형된 공식이 요구됨.
  - 기댓값(1) = 기초확률공식 활용 (Balanced Population)
  - 기댓값(2) = 도출된 공식
  - 기댓값(3) = 기댓값(2)를 인수분해한 최종공식. (Unbalanced Population)
